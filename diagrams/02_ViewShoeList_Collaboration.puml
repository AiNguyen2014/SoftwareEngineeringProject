@startuml ViewShoeList_Collaboration
!theme plain

title View Shoe List

actor "Registered Customer\nUnregistered Customer" as user
rectangle ":ShoeListUI" as ui
rectangle ":ShoesController" as controller
rectangle ":ShoesService" as service
rectangle ":ShoesRepository" as repo
database "Database" as db

user -right-> ui: 1: Truy cap trang chu

ui -right-> controller: 1.1: GET /(page, size)

controller -down-> service: 1.1.1: getShoesList(page, size)

service -down-> repo: 1.1.1.1: findAllPaged(pageable)

repo -down-> db: SELECT s FROM Shoes s

db -up-> repo: Page<Shoes>

repo -up-> service: 1.1.1.2: Page<Shoes>

service -down-> repo: 1.1.1.3: findAllByIdsWithImages(shoeIds)

repo -down-> db: SELECT DISTINCT s\nLEFT JOIN FETCH s.images\nWHERE s.shoeId IN ids

db -up-> repo: List<Shoes>

repo -up-> service: List<Shoes> with images

service -right-> service: 1.1.1.4: convertToSummaryDto(shoes)

service -up-> controller: 1.1.2: ShoesListDto

controller -up-> ui: 1.2: render(model)

ui -up-> user: Hien thi giao dien danh sach

@enduml
